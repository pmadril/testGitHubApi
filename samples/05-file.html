<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>gh3</title>
    
</head>
<body>
	<h1></h1>
	<h2></h2>
	<ul></ul>
	<textarea></textarea>

  <script src="../javascripts/jquery-2.1.0.min.js"></script>
  <script src="../javascripts/underscore-min.js"></script>
  <script src="../javascripts/gh3.js"></script>
  <script>

    var k33g = new Gh3.User("pmadril")
      ,	repoTitle = $("h1")
      ,	branchTitle = $("h2")
      ,	branchContents = $("ul")
      ,	rawContent = $("textarea");

    var k33gBlog = new Gh3.Repository("testGitHubApi", k33g);

    k33gBlog.fetch(function (err, res) {
      if(err) { throw "outch ..." }

      repoTitle.html(k33gBlog.full_name);

      k33gBlog.fetchBranches(function (err, res) {
        if(err) { throw "outch ..." }

        var master = k33gBlog.getBranchByName("master");
        branchTitle.html(master.name + " (" + master.sha + ") :");

        master.fetchContents(function (err, res) {
          if(err) { throw "outch ..." }

          master.eachContent(function (content) {
            branchContents.append('<li>'+content.name+" : "+content.type);

          });

          //var myfile = master.getContents()[8];

          var myfile = master.getFileByName("README.md");

          console.log("README.md", myfile);

          myfile.fetchContent(function (err, res) {
            if(err) { throw "outch ..." }

            rawContent.text(myfile.getRawContent());
          });

          myfile.fetchCommits(function (err, res) {
            if(err) { throw "outch ..." }

            console.log(myfile.getCommits());

            myfile.eachCommit(function (commit) {
              console.log(commit.author.login, commit.message, commit.date);
            });
          });

        });

      })
    });


  </script>
    <div id="content">
      <form>
          <input id="_repository" value="{{ page.repository }}">
        <input id="postTitle" name="postTitle" placeholder="Enter the post title..." >
        <br />
        <div id="postEditor">
          <textarea id="postMarkdown" placeholder="Write your post..."></textarea>
          <div id="postPreview"></div>
        </div>
        <a class="btn info" data-controls-modal="commit-modal" data-backdrop="static">Commit</a>
      </form>

      <div id="commit-modal" class="modal hide fade">
        <div class="modal-header">
          <a href="#" class="close">Ã—</a>
          <h3>Okay, just one more step!</h3>
        </div>
        <div class="modal-body">
          <input id="username" name="username" placeholder="Enter GitHub username..." >
          <input id="password" name="password" type="password" placeholder="Password...">
          <a href="#">Why?</a>
        </div>
        <div class="modal-footer">
          <a href="#" class="btn info" id="commitButton">Commit this Post</a>
        </div>
      </div>
</div>
  
</body>

</html>
